#! /usr/bin/env ruby

require 'rubygems'
require 'fuzzyclock'
require 'optparse'

class FuzzyClockCommand
  
  def self.run
    fc = self.new
    fc.parse_options
    fc.execute
  end
  
  def options
    @options ||= {}
  end
  
  def execute
    t = FuzzyClock.new
    t.locale = options[:locale] if options[:locale]
    
    output  = ""
    output += "It's about " if options[:about]
    output += t.to_s
    
    output.upcase! if options[:upcase]
    output.capitalize! if options[:capitalize]
    
    puts output
  end
  
  def parse_options
    OptionParser.new { |opts|
      opts.banner = "Usage: #{File.basename(__FILE__)} [options]"

      opts.on("-a", "--about", "Say about?") do |v|
        self.options[:about] = v
      end
      
      opts.on("-l", "--locale", "Langage") do |v|
        self.options[:locale] = v
      end
      
      opts.on("-U", "--uppercase", "UPPERCASE OUTPUT") do |v|
        self.options[:upcase] = v
      end
      
      opts.on("-C", "--capitalize", "Capitalize Output") do |v|
        self.options[:capitalize] = v
      end
      
    }.parse!
  end
  
end

FuzzyClockCommand.run
